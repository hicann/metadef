# 构造函数<a name="ZH-CN_TOPIC_0000002518460601"></a>

## 函数功能<a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_section36583473819"></a>

用于构造指定的Tensor对象。TensorV2类用来描述一个Tensor对象的信息以及行为，包含：形状、数据格式、数据类型、步长、偏移以及tensor数据内容tensordata。

## 函数原型<a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_section13230182415108"></a>

```
TensorV2()   //默认构造函数
TensorV2 (const StorageShape &storage_shape, const StorageFormat &storage_format, const TensorPlacement placement, const ge::DataType data_type, TensorAddress addr)
TensorV2(const StorageShape &storage_shape, const StorageFormat &storage_format, ge::DataType data_type)
TensorV2(const StorageShape &storage_shape, const StorageFormat &storage_format, const TensorPlacement placement, const ge::DataType data_type, TensorAddress addr, TensorAddrManager manager)
TensorV2(const StorageShape &storage_shape, const StorageFormat &storage_format, const TensorPlacement placement, const ge::DataType data_type, TensorAddress addr, TensorAddrManager manager, const Stride &stride, const int64_t offset)
```

## 参数说明<a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_section75395119104"></a>

<a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_table111938719446"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_row6223476444"><th class="cellrowborder" valign="top" width="12.2%" id="mcps1.1.4.1.1"><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p10223674448"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p10223674448"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p10223674448"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="10.879999999999999%" id="mcps1.1.4.1.2"><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p645511218169"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p645511218169"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p645511218169"></a>输入/输出</p>
</th>
<th class="cellrowborder" valign="top" width="76.92%" id="mcps1.1.4.1.3"><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1922337124411"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1922337124411"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1922337124411"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_row152234713443"><td class="cellrowborder" valign="top" width="12.2%" headers="mcps1.1.4.1.1 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p51918481213"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p51918481213"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p51918481213"></a>storage_shape</p>
</td>
<td class="cellrowborder" valign="top" width="10.879999999999999%" headers="mcps1.1.4.1.2 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p191819441211"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p191819441211"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p191819441211"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="76.92%" headers="mcps1.1.4.1.3 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p16171244128"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p16171244128"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p16171244128"></a>指定tensor的形状信息。<a href="StorageShape.md">StorageShape</a>类型。</p>
</td>
</tr>
<tr id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_row125412192439"><td class="cellrowborder" valign="top" width="12.2%" headers="mcps1.1.4.1.1 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p181654101217"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p181654101217"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p181654101217"></a>storage_format</p>
</td>
<td class="cellrowborder" valign="top" width="10.879999999999999%" headers="mcps1.1.4.1.2 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p18157411216"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p18157411216"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p18157411216"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="76.92%" headers="mcps1.1.4.1.3 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p8146419129"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p8146419129"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p8146419129"></a>指定tensor的数据格式信息。<a href="StorageFormat.md">StorageFormat</a>类型。</p>
</td>
</tr>
<tr id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_row65831331194318"><td class="cellrowborder" valign="top" width="12.2%" headers="mcps1.1.4.1.1 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p141214995818"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p141214995818"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p141214995818"></a>placement</p>
</td>
<td class="cellrowborder" valign="top" width="10.879999999999999%" headers="mcps1.1.4.1.2 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p201209915582"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p201209915582"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p201209915582"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="76.92%" headers="mcps1.1.4.1.3 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1331055414415"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1331055414415"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1331055414415"></a>指定tensor的实际数据所存储的device位置。<a href="TensorPlacement.md">TensorPlacement</a>类型。</p>
</td>
</tr>
<tr id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_row947517111214"><td class="cellrowborder" valign="top" width="12.2%" headers="mcps1.1.4.1.1 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1247531181210"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1247531181210"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p1247531181210"></a>data_type</p>
</td>
<td class="cellrowborder" valign="top" width="10.879999999999999%" headers="mcps1.1.4.1.2 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p147518151215"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p147518151215"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p147518151215"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="76.92%" headers="mcps1.1.4.1.3 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p11691441104114"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p11691441104114"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p11691441104114"></a>指定tensor的datatype信息。<a href="DataType.md">ge::DataType</a>类型。</p>
</td>
</tr>
<tr id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_row1747601151215"><td class="cellrowborder" valign="top" width="12.2%" headers="mcps1.1.4.1.1 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p5476919128"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p5476919128"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p5476919128"></a>addr</p>
</td>
<td class="cellrowborder" valign="top" width="10.879999999999999%" headers="mcps1.1.4.1.2 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p147620151212"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p147620151212"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p147620151212"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="76.92%" headers="mcps1.1.4.1.3 "><p id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p94761211127"><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p94761211127"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_p94761211127"></a>指定tensor的实际数据所存储的内存地址。TensorAddress类型，定义如下：</p>
<a name="screen3729113105"></a><a name="screen3729113105"></a><pre class="screen" codetype="Cpp" id="screen3729113105">using TensorAddress = void *;</pre>
</td>
</tr>
<tr id="zh-cn_topic_0000001633985549_row2213174242818"><td class="cellrowborder" valign="top" width="12.2%" headers="mcps1.1.4.1.1 "><p id="zh-cn_topic_0000001633985549_p19214154292816"><a name="zh-cn_topic_0000001633985549_p19214154292816"></a><a name="zh-cn_topic_0000001633985549_p19214154292816"></a>manager</p>
</td>
<td class="cellrowborder" valign="top" width="10.879999999999999%" headers="mcps1.1.4.1.2 "><p id="zh-cn_topic_0000001633985549_p172141042202818"><a name="zh-cn_topic_0000001633985549_p172141042202818"></a><a name="zh-cn_topic_0000001633985549_p172141042202818"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="76.92%" headers="mcps1.1.4.1.3 "><p id="zh-cn_topic_0000001633985549_p12149425289"><a name="zh-cn_topic_0000001633985549_p12149425289"></a><a name="zh-cn_topic_0000001633985549_p12149425289"></a>tensor data的管理函数，若manager为空，则认为addr就是tensor的数据地址，且此数据不需要被释放。</p>
<a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339549070_screen798405818183"></a><a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339549070_screen798405818183"></a><pre class="screen" codetype="Cpp" id="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339549070_screen798405818183">using TensorAddrManager = ge::graphStatus (*)(TensorAddress addr, TensorOperateType operate_type, void **out);
enum TensorOperateType {
  kGetTensorAddress,  ///&lt; 获取Tensor的地址  
  kFreeTensor,        ///&lt; 释放Tensor  
  kPlusShareCount,    ///&lt; 共享Tensor  
  kTensorOperateType
};</pre>
</td>
</tr>
<tr id="row4589133516230"><td class="cellrowborder" valign="top" width="12.2%" headers="mcps1.1.4.1.1 "><p id="p85901435102310"><a name="p85901435102310"></a><a name="p85901435102310"></a>stride</p>
</td>
<td class="cellrowborder" valign="top" width="10.879999999999999%" headers="mcps1.1.4.1.2 "><p id="p35901135192320"><a name="p35901135192320"></a><a name="p35901135192320"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="76.92%" headers="mcps1.1.4.1.3 "><p id="p1818105711236"><a name="p1818105711236"></a><a name="p1818105711236"></a>指定tensor的步长信息。Stride类型。</p>
</td>
</tr>
<tr id="row13530138142413"><td class="cellrowborder" valign="top" width="12.2%" headers="mcps1.1.4.1.1 "><p id="p12531143852410"><a name="p12531143852410"></a><a name="p12531143852410"></a>offset</p>
</td>
<td class="cellrowborder" valign="top" width="10.879999999999999%" headers="mcps1.1.4.1.2 "><p id="p353173819248"><a name="p353173819248"></a><a name="p353173819248"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="76.92%" headers="mcps1.1.4.1.3 "><p id="p11531163882411"><a name="p11531163882411"></a><a name="p11531163882411"></a>指定tensor的偏移信息。int64_t类型。</p>
</td>
</tr>
</tbody>
</table>

## 返回值说明<a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_section25791320141317"></a>

返回一个初始化的Tensor对象。

## 约束说明<a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_section19165124931511"></a>

Tensor中的成员（format、shape, stride, offset等）的值均需要显式设置，否则均为未定义值。

TensorV2类不支持入图场景。

TensorV2类型指针转换为Tensor类型指针后可调用Tensor的成员函数。

Tensor类型指针转换为TensroV2类型指针前需要通过GetVersion\(\)获取版本号，只有kTensorV2才能进行转换。

## 调用示例<a name="zh-cn_topic_0000001633985549_zh-cn_topic_0000001339551770_section320753512363"></a>

```
TensorV2 tensor{{{8, 3, 224, 224}, {16, 3, 224, 224}},       // shape                
                {ge::FORMAT_ND, ge::FORMAT_FRACTAL_NZ, {}},  // format                              
                kFollowing,                                  // placement                
                ge::DT_FLOAT16,                              //dt                
                nullptr};
```

